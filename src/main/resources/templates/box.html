<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>lol</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>
<style>

    header{
        background-color: #041022;
            margin-bottom: 30px;
    }
    body{
        background-color: black;
        margin: 0 auto;

    }
    .header-display{
        border-bottom: 3px solid #1F2834;
        display: flex;
        padding: 30px 0;

    }
    .header-title{
    font-size: 35px;
    font-weight: bold;
    color: white;
    margin-bottom: 0;
    padding-left: 50px;
    }
    .header-nav{
        display: flex;
    align-items: center;
    }
    .header-nav > ul{
        display: flex;
    flex-direction: row;
    color: #B5AD83;
    font-size: 20px;
    font-weight: 600;
    list-style: none;
    margin: 0 auto;
}
    .display-flex{
        display: flex;
    flex-direction: column;
    align-items: center;
    }
    .btn{
    background-color: #1E2428;
    border-color: #A48637;
    margin-bottom: 25px;
    border: 4px solid #A48637;
    padding: 9px 30px;
    border-radius: 0;
}

.btn > p {
    color: #B5AD83;
    font-size: 18px;
    font-weight: 600;
    margin: 0;
}
#resultImage{
    height: 500px;
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
    
    display: flex;
    align-items: flex-end;
    justify-content: center;
}
.ListHeader{
margin-top: 35px;
    margin-bottom: 20px;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
}
.ListHeader > p {
    font-size: 18px;
    color: #B5AD83;
    font-weight: bold;
    margin-left: 30px;
    margin-bottom: 0;
}
.boxResultList{
    border-top: 3px double #3F3624;
    border-bottom: 3px double #3F3624;
    margin-left: 25px;

}
.boxResultList > ul {
    min-height: 540px;
    max-height: 540px;
    overflow-y: auto;
    margin-top: 16px;
    list-style: none;

}
.boxResultList > ul >li {
    color: #f9e5bc;
    font-weight: bold;
    font-size: 16px;
    margin-bottom: 15px;
}
.boxResultList > ul > li > img{
    width: 125px;
    margin-right: 20px;
}
.boxResultList > ul::-webkit-scrollbar {
    width: 8px;
}
.boxResultList >ul::-webkit-scrollbar-thumb{
    height: 30%;
    background: #3F3624;
    border-radius: 7px;
}
.boxResultList >ul::-webkit-scrollbar-track{
    background: #1a1918;
}
.btn-close{
    --bs-btn-close-bg:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='white'%3e%3cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3e%3c/svg%3e")
}

#getAllSkin{

    border: 1px solid;
    height: 42px;
    font-size: 15px;
    font-weight: 600;
    background-color: #22201b;
    color: #a4996f;
}
#allSkin {
 overflow-y: scroll;
 padding-left: 10px;
}

#allSkin > li > img {
    width: 50px;
    height: 50px;
    margin-right: 8px;

}#allSkin > li  {
    color: #bfbbac;
    font-size: 13px;
    font-weight: 500;
    margin-bottom: 8px;
}
#skinModal-body{
    display: flex;
    min-height: 500px;
    max-height: 500px;
}

#allSkin::-webkit-scrollbar {
    width: 8px;
}
#allSkin::-webkit-scrollbar-thumb{
    height: 30%;
    background: #3F3624;
    border-radius: 7px;
}
#allSkin::-webkit-scrollbar-track{
    background: #1a1918;
}

.modal-header{
    border-bottom: none;
    padding-bottom: 5px;
}
    </style>
<body>
    <header>
        <div class="header-display">
            <div> <p class="header-title">LEAGUE OF LEGENDS</p></div>
            <nav class="header-nav">
                <ul>
                    <li style="    margin-right: 35px;
                    margin-left: 10px;">
                        <a>상자깡</a>
                    </li>

                </ul>
            </nav>
        </div>
    </header>

        <div class="container"style="
        display: flex;
        flex-direction: row;
    ">
            <div class="col-5">
                <div class="ListHeader"><p>목록</p><button id="getAllSkin">스킨 전체보기</button></div>
                <div class="boxResultList">
                    <ul class="ResultUl" id="resultUl">

                    </ul>
                </div>

            </div>
            <div class="col-7 display-flex"style="
    top: -31px;
    position: relative;
">
                
                <div style="
                display: flex;
                align-items: center;
                flex-direction: column;
                z-index: -30;
            "><p style="
    color: #B5AD83;
    font-size: 25px;
    font-weight: 600;
    position: absolute;
    top: 109px;
">명품상자</p><img id="boxImage" src="../img/Masterwork_Chest.gif" style="height: 650px;"></div>
                <div style="
                top: -85px;
                position: relative;
            ">
                    <div style="margin-bottom: 35px;margin-top: -20px;"><p id="count" style="
                        font-size: 18px;
                        color: #d4d1c4;
                        font-weight: 600;
                        text-align: center;
                    ">횟수: 0</p></div>
                    <div><button class="btn" id="openBox"style="
                        margin-right: 20px;
                        width: 130px;
                    "><p>열기</p></button>
                    <button id="reset"class="btn"style="
                    
                    width: 130px;
                "><p>리셋</p></button></div>
                </div>
            </div>
        </div>

<!-- Modal -->
<div class="modal fade " id="testModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content"style="
      background: none;
  "  >

          <button id="btn-close"type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="
          align-self: end;
      "></button>
        <div  class="modal-body" id="resultImage">
            <div>
                <p id="boxResultText"style="
                font-size: 28px;
                font-weight: 600;
                color: #B5AD83;
            "></p>
            </div>
        </div>

      </div>
    </div>
  </div>

  <!--스킨전체목록 Modal -->
<div class="modal fade " id="skinModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm">
      <div class="modal-content" style="background-color: #151515;">
        <div class="modal-header">
          <button id="btn-close"type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="
          align-self: end;
      "></button>
         
        </div>


        <div  class="modal-body" id="skinModal-body" >

            <ul id="allSkin" style="list-style: none;">
                
            </ul>
            </div>
        </div>

      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>    

    <script>
        //상자깡 이미지


                document.getElementById('openBox').addEventListener('click', function() {
                    getRandomSkins();
                    
                    var count = document.getElementById('count');
                    count.innerText= '횟수: ' + boxCount;
                    
                        var boxResultImage = document.getElementById('resultImage');
                        var boxResultText = document.getElementById('boxResultText');
                        
                        var tempImg = new Image();
            tempImg.src = randomSkins[boxCount -1].imageUrl;
            tempImg.onload = function() {
                boxResultImage.style.backgroundImage = "url(" + randomSkins[boxCount -1].imageUrl + ")";
                boxResultText.innerText = randomSkins[boxCount -1].name;
            };
                    
                    

                    document.getElementById('boxImage').src = '../img/boxOpening.gif';

      setTimeout(function() {
        var myModal = new bootstrap.Modal(document.getElementById('testModal'));
        myModal.show();
      }, 1900); 

    });

    
    
    document.getElementById('btn-close').addEventListener('click',function(){
      
      document.getElementById('boxImage').src = '../img/Masterwork_Chest.gif';
                      //결과목록에 추가
                      var ul = document.getElementById('resultUl');

             
var Img = new Image();
Img.src =  randomSkins[boxCount -1].tiles;
Img.onload = function() {
ul.insertAdjacentHTML('beforeend', '<li><img src="' + randomSkins[boxCount -1].tiles + '">' + randomSkins[boxCount -1].name+ '</li>');
};
    });
    
    document.getElementById('reset').addEventListener('click', function() {
        document.location.reload();

    });
    

    document.getElementById('getAllSkin').addEventListener('click', function() {

                      //결과목록에 추가
                      var ul = document.getElementById('allSkin');

             

for (let i = 0; i < allSkins.length; i++) {

    var Img = new Image();
Img.src =  allSkins[i].tiles;
Img.onload = function() {
ul.insertAdjacentHTML('beforeend', '<li><img src="' + allSkins[i].tiles + '">' + allSkins[i].name+ '</li>');
}


            }
        var skinModal = new bootstrap.Modal(document.getElementById('skinModal'));
        skinModal.show();
    });
    

// 롤 api
var urlAPI = "https://ddragon.leagueoflegends.com/cdn/14.10.1/data/ko_KR/champion.json";
        var allSkins = [];
        const randomSkins = [];
        let boxCount = 0;

        
        $.ajax({
            type: "GET",
            url: urlAPI,
            dataType: "json",
            async: false, // 동기 상태 => ajax는 기본적으로 비동기다.
            success: function (data) {
                const champions = data.data;

                // 모든 챔피언에 대해 개별 요청
                for (const key in champions) {
                    if (champions.hasOwnProperty(key)) {
                        const champion = champions[key];
                        //console.log("key=" + key);
                        fetchChampionSkins(champion.id);
                        
                    }
                    
                }
                
            },
            error: function (request, status, error) {
                console.log("code:" + request.status);
                console.log("message:" + request.responseText);
                console.log("error:" + error);
            },
        });

        function fetchChampionSkins(championId) {
            var championDetailAPI = `https://ddragon.leagueoflegends.com/cdn/14.10.1/data/ko_KR/champion/${championId}.json`;

            $.ajax({
                type: "GET",
                url: championDetailAPI,
                dataType: "json",
                async: false,
                success: function (data) {
                    const championData = data.data[championId];
                    const skins = championData.skins;

                    // 각 스킨 이미지 URL 생성 및 출력
                    skins.forEach(skin => {
                        const skinImageUrl = `http://ddragon.leagueoflegends.com/cdn/img/champion/centered/${championId}_${skin.num}.jpg`;
                        const skinTilesImageUrl = `http://ddragon.leagueoflegends.com/cdn/img/champion/tiles/${championId}_${skin.num}.jpg`;
                        
                        if(skin.num != 0){
                        allSkins.push({
                            name: skin.name,
                            imageUrl: skinImageUrl,
                            tiles: skinTilesImageUrl
                        });
                    }
                    });
                },
                error: function (request, status, error) {
                    console.log("code:" + request.status);
                    console.log("message:" + request.responseText);
                    console.log("error:" + error);
                },
            });
        }
        function getRandomSkins() {
            
            const skinCount = allSkins.length;

            for (let i = 0; i < 1; i++) {
                const randomIndex = Math.floor(Math.random() * skinCount);
                randomSkins.push(allSkins[randomIndex]);

                boxCount++
                

                console.log("count: " + boxCount);
                console.log("skin: " + allSkins[randomIndex].name);
            }
                
        }

        
    </script>
</body>
</html>